{"ast":null,"code":"import Parse from 'parse';\nimport { withState, withHandlers, pipe, withLifecycle } from '../../util';\nconst ClouseQuery = Parse.Object.extend('ClouseQuery');\n\nconst init = props => props.filterData; // const makeMainQuery = ({ data, setData }) => () => {\n//   console.log();\n//   console.log('makemain query');\n//   let mainQuery = new Parse.Query(ClouseQuery);\n//   if (data.op === 'and') {\n//     data.childs.map((item) => {\n//       if (!item.childs) { mainQuery = Parse.Query.and(mainQuery, item); } else {\n//         mainQuery = Parse.Query.and(mainQuery, item.mainQuery);\n//       }\n//     });\n//   } else {\n//     data.childs.map((item) => {\n//       if (!item.childs) { mainQuery = Parse.Query.or(mainQuery, item); } else {\n//         mainQuery = Parse.Query.and(mainQuery, item.mainQuery);\n//       }\n//     });\n//   }\n//   const newdd = { ...data };\n//   newdd.mainQuery = mainQuery;\n//   newdd.mainQuery.find().then((response) => {\n//     newdd.searchResults = response;\n//     console.log(response);\n//   });\n//   console.log(newdd.searchResults);\n//   console.log(newdd.mainQuery);\n//   setData(newdd);\n// };\n\n\nconst addClouse = ({\n  setData,\n  data\n}) => () => {\n  const query = new Parse.Query(ClouseQuery);\n  const newd = { ...data\n  };\n  newd.childs = newd.childs.concat(query);\n  setData(newd);\n};\n\nconst deleteChild = ({\n  setData,\n  data\n}) => index => {\n  const newd = { ...data\n  };\n  newd.childs = newd.childs.filter((value, i) => i !== index);\n  setData(newd);\n};\n\nconst changeOprand = ({\n  setData,\n  data\n}) => oprand => {\n  const newd = { ...data\n  };\n  newd.op = oprand;\n  setData(newd); // setData((d) => d.set('op', oprand));\n};\n\nconst addOprand = ({\n  setData,\n  data,\n  filterData\n}) => () => {\n  const newd = { ...data\n  };\n  newd.childs = newd.childs.concat(filterData);\n  setData(newd); // setData((d) => d.set('childs', d.childs.concat(Record({ op: 'and', childs: [], mainQuery: query })())));\n};\n\nconst addObject = () => () => {\n  const obj = new Parse.Object('ClouseQuery');\n  obj.save({\n    name: 'rox',\n    number: 456\n  });\n};\n\nconst onUpdate = props => {\n  if (props) {\n    console.log(props);\n    props.makeMainQuery(props.data);\n  }\n};\n\nconst oprandController = pipe(withState(init), withHandlers({\n  // makeMainQuery,\n  addClouse,\n  deleteChild,\n  changeOprand,\n  addOprand,\n  addObject\n}), withLifecycle({\n  onUpdate\n}));\nexport default oprandController;","map":{"version":3,"sources":["/home/roxana/React-Project/datafilter/src/components/oprand/oprandController.js"],"names":["Parse","withState","withHandlers","pipe","withLifecycle","ClouseQuery","Object","extend","init","props","filterData","addClouse","setData","data","query","Query","newd","childs","concat","deleteChild","index","filter","value","i","changeOprand","oprand","op","addOprand","addObject","obj","save","name","number","onUpdate","console","log","makeMainQuery","oprandController"],"mappings":"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","sourcesContent":["\nimport Parse from 'parse';\nimport {\n  withState, withHandlers, pipe, withLifecycle,\n} from '../../util';\n\n\nconst ClouseQuery = Parse.Object.extend('ClouseQuery');\n\nconst init = (props) => props.filterData;\n\n// const makeMainQuery = ({ data, setData }) => () => {\n//   console.log();\n//   console.log('makemain query');\n//   let mainQuery = new Parse.Query(ClouseQuery);\n//   if (data.op === 'and') {\n//     data.childs.map((item) => {\n//       if (!item.childs) { mainQuery = Parse.Query.and(mainQuery, item); } else {\n//         mainQuery = Parse.Query.and(mainQuery, item.mainQuery);\n//       }\n//     });\n//   } else {\n//     data.childs.map((item) => {\n//       if (!item.childs) { mainQuery = Parse.Query.or(mainQuery, item); } else {\n//         mainQuery = Parse.Query.and(mainQuery, item.mainQuery);\n//       }\n//     });\n//   }\n//   const newdd = { ...data };\n//   newdd.mainQuery = mainQuery;\n//   newdd.mainQuery.find().then((response) => {\n//     newdd.searchResults = response;\n//     console.log(response);\n//   });\n//   console.log(newdd.searchResults);\n//   console.log(newdd.mainQuery);\n//   setData(newdd);\n// };\n\nconst addClouse = ({ setData, data }) => () => {\n  const query = new Parse.Query(ClouseQuery);\n  const newd = { ...data };\n  newd.childs = newd.childs.concat(query);\n  setData(newd);\n};\n\nconst deleteChild = ({ setData, data }) => (index) => {\n  const newd = { ...data };\n  newd.childs = newd.childs.filter((value, i) => i !== index);\n  setData(newd);\n};\n\nconst changeOprand = ({ setData, data }) => (oprand) => {\n  const newd = { ...data };\n  newd.op = oprand;\n  setData(newd);\n\n  // setData((d) => d.set('op', oprand));\n};\n\nconst addOprand = ({ setData, data, filterData }) => () => {\n  const newd = { ...data };\n  newd.childs = newd.childs.concat(filterData);\n  setData(newd);\n  // setData((d) => d.set('childs', d.childs.concat(Record({ op: 'and', childs: [], mainQuery: query })())));\n};\n\n\nconst addObject = () => () => {\n  const obj = new Parse.Object('ClouseQuery');\n  obj.save({\n    name: 'rox',\n    number: 456,\n\n  });\n};\n\nconst onUpdate = (props) => {\n  if (props) {\n    console.log(props);\n    props.makeMainQuery(props.data);\n  }\n};\n\n\nconst oprandController = pipe(\n  withState(init),\n  withHandlers({\n    // makeMainQuery,\n    addClouse,\n    deleteChild,\n    changeOprand,\n    addOprand,\n    addObject,\n  }),\n  withLifecycle({\n    onUpdate,\n  }),\n\n);\n\nexport default oprandController;\n"]},"metadata":{},"sourceType":"module"}