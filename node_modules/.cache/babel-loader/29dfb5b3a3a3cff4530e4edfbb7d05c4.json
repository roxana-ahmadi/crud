{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\"));\n\nvar _defineProperties = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\"));\n\nvar _getOwnPropertyDescriptors = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _getOwnPropertyDescriptor = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _getOwnPropertySymbols = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\n\nvar _defineProperty3 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\n\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\n\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = (0, _keys.default)(object);\n\n  if (_getOwnPropertySymbols.default) {\n    var symbols = (0, _getOwnPropertySymbols.default)(object);\n    if (enumerableOnly) symbols = (0, _filter.default)(symbols).call(symbols, function (sym) {\n      return (0, _getOwnPropertyDescriptor.default)(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context2;\n\n      (0, _forEach.default)(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) {\n        (0, _defineProperty3.default)(target, key, source[key]);\n      });\n    } else if (_getOwnPropertyDescriptors.default) {\n      (0, _defineProperties.default)(target, (0, _getOwnPropertyDescriptors.default)(source));\n    } else {\n      var _context3;\n\n      (0, _forEach.default)(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n        (0, _defineProperty2.default)(target, key, (0, _getOwnPropertyDescriptor.default)(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar useXDomainRequest = false;\n\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\n  useXDomainRequest = true;\n}\n\nfunction ajaxIE9(method\n/*: string*/\n, url\n/*: string*/\n, data\n/*: any*/\n, headers\n/*:: ?: any*/\n, options\n/*:: ?: FullOptions*/\n) {\n  return new _promise.default(function (resolve, reject) {\n    var xdr = new XDomainRequest();\n\n    xdr.onload = function () {\n      var response;\n\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        reject(e);\n      }\n\n      if (response) {\n        resolve({\n          response: response\n        });\n      }\n    };\n\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: (0, _stringify.default)({\n          code: _ParseError.default.X_DOMAIN_REQUEST,\n          error: 'IE\\'s XDomainRequest does not supply error info.'\n        })\n      };\n      reject(fakeResponse);\n    };\n\n    xdr.onprogress = function () {\n      if (options && typeof options.progress === 'function') {\n        options.progress(xdr.responseText);\n      }\n    };\n\n    xdr.open(method, url);\n    xdr.send(data);\n\n    if (options && typeof options.requestTask === 'function') {\n      options.requestTask(xdr);\n    }\n  });\n}\n\nvar RESTController = {\n  ajax: function (method\n  /*: string*/\n  , url\n  /*: string*/\n  , data\n  /*: any*/\n  , headers\n  /*:: ?: any*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    if (useXDomainRequest) {\n      return ajaxIE9(method, url, data, headers, options);\n    }\n\n    var res, rej;\n    var promise = new _promise.default(function (resolve, reject) {\n      res = resolve;\n      rej = reject;\n    });\n    promise.resolve = res;\n    promise.reject = rej;\n    var attempts = 0;\n\n    var dispatch = function dispatch() {\n      if (XHR == null) {\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\n      }\n\n      var handled = false;\n      var xhr = new XHR();\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\n          return;\n        }\n\n        handled = true;\n\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.responseText);\n\n            if (typeof xhr.getResponseHeader === 'function') {\n              var _context;\n\n              if ((0, _includes.default)(_context = xhr.getAllResponseHeaders() || '').call(_context, 'x-parse-job-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-job-status-id');\n              }\n            }\n          } catch (e) {\n            promise.reject(e.toString());\n          }\n\n          if (response) {\n            promise.resolve({\n              response: response,\n              status: xhr.status,\n              xhr: xhr\n            });\n          }\n        } else if (xhr.status >= 500 || xhr.status === 0) {\n          // retry on 5XX or node-xmlhttprequest error\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\n            // Exponentially-growing random delay\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\n            (0, _setTimeout2.default)(dispatch, delay);\n          } else if (xhr.status === 0) {\n            promise.reject('Unable to connect to the Parse API');\n          } else {\n            // After the retry limit is reached, fail\n            promise.reject(xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      };\n\n      headers = headers || {};\n\n      if (typeof headers['Content-Type'] !== 'string') {\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\n      }\n\n      if (_CoreManager.default.get('IS_NODE')) {\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\n      }\n\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\n      }\n\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\n\n      for (var key in customHeaders) {\n        headers[key] = customHeaders[key];\n      }\n\n      xhr.onprogress = function (event) {\n        if (options && typeof options.progress === 'function') {\n          if (event.lengthComputable) {\n            options.progress(event.loaded / event.total, event.loaded, event.total);\n          } else {\n            options.progress(null);\n          }\n        }\n      };\n\n      xhr.open(method, url, true);\n\n      for (var h in headers) {\n        xhr.setRequestHeader(h, headers[h]);\n      }\n\n      xhr.onabort = function () {\n        promise.resolve({\n          response: {\n            results: []\n          },\n          status: 0,\n          xhr: xhr\n        });\n      };\n\n      xhr.send(data);\n\n      if (options && typeof options.requestTask === 'function') {\n        options.requestTask(xhr);\n      }\n    };\n\n    dispatch();\n    return promise;\n  },\n  request: function (method\n  /*: string*/\n  , path\n  /*: string*/\n  , data\n  /*: mixed*/\n  , options\n  /*:: ?: RequestOptions*/\n  ) {\n    options = options || {};\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += path;\n    var payload = {};\n\n    if (data && (0, _typeof2.default)(data) === 'object') {\n      for (var k in data) {\n        payload[k] = data[k];\n      }\n    }\n\n    if (method !== 'POST') {\n      payload._method = method;\n      method = 'POST';\n    }\n\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\n\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\n\n    if (jsKey) {\n      payload._JavaScriptKey = jsKey;\n    }\n\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\n    var useMasterKey = options.useMasterKey;\n\n    if (typeof useMasterKey === 'undefined') {\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\n    }\n\n    if (useMasterKey) {\n      if (_CoreManager.default.get('MASTER_KEY')) {\n        delete payload._JavaScriptKey;\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\n      } else {\n        throw new Error('Cannot use the Master Key, it has not been provided.');\n      }\n    }\n\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\n      payload._RevocableSession = '1';\n    }\n\n    var installationId = options.installationId;\n    var installationIdPromise;\n\n    if (installationId && typeof installationId === 'string') {\n      installationIdPromise = _promise.default.resolve(installationId);\n    } else {\n      var installationController = _CoreManager.default.getInstallationController();\n\n      installationIdPromise = installationController.currentInstallationId();\n    }\n\n    return installationIdPromise.then(function (iid) {\n      payload._InstallationId = iid;\n\n      var userController = _CoreManager.default.getUserController();\n\n      if (options && typeof options.sessionToken === 'string') {\n        return _promise.default.resolve(options.sessionToken);\n      } else if (userController) {\n        return userController.currentUserAsync().then(function (user) {\n          if (user) {\n            return _promise.default.resolve(user.getSessionToken());\n          }\n\n          return _promise.default.resolve(null);\n        });\n      }\n\n      return _promise.default.resolve(null);\n    }).then(function (token) {\n      if (token) {\n        payload._SessionToken = token;\n      }\n\n      var payloadString = (0, _stringify.default)(payload);\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\n        var response = _ref.response,\n            status = _ref.status;\n\n        if (options.returnStatus) {\n          return _objectSpread({}, response, {\n            _status: status\n          });\n        } else {\n          return response;\n        }\n      });\n    }).catch(function (response\n    /*: { responseText: string }*/\n    ) {\n      // Transform the error into an instance of ParseError by trying to parse\n      // the error string as JSON\n      var error;\n\n      if (response && response.responseText) {\n        try {\n          var errorJSON = JSON.parse(response.responseText);\n          error = new _ParseError.default(errorJSON.code, errorJSON.error);\n        } catch (e) {\n          // If we fail to parse the error text, that's okay.\n          error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\n        }\n      } else {\n        error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(response));\n      }\n\n      return _promise.default.reject(error);\n    });\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  }\n};\nmodule.exports = RESTController;","map":{"version":3,"sources":["/home/roxana/React-Project/crud/node_modules/parse/lib/browser/RESTController.js"],"names":["_interopRequireDefault","require","_defineProperty2","_defineProperties","_getOwnPropertyDescriptors","_forEach","_getOwnPropertyDescriptor","_filter","_getOwnPropertySymbols","_keys","_defineProperty3","_typeof2","_setTimeout2","_includes","_stringify","_promise","_CoreManager","_ParseError","ownKeys","object","enumerableOnly","keys","default","symbols","call","sym","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","_context2","Object","key","_context3","XHR","XMLHttpRequest","useXDomainRequest","XDomainRequest","ajaxIE9","method","url","data","headers","options","resolve","reject","xdr","onload","response","JSON","parse","responseText","e","onerror","ontimeout","fakeResponse","code","X_DOMAIN_REQUEST","error","onprogress","progress","open","send","requestTask","RESTController","ajax","res","rej","promise","attempts","dispatch","Error","handled","xhr","onreadystatechange","readyState","_aborted","status","getResponseHeader","_context","getAllResponseHeaders","toString","get","delay","Math","round","random","pow","process","versions","node","customHeaders","event","lengthComputable","loaded","total","h","setRequestHeader","onabort","results","request","path","payload","k","_method","_ApplicationId","jsKey","_JavaScriptKey","_ClientVersion","useMasterKey","_MasterKey","_RevocableSession","installationId","installationIdPromise","installationController","getInstallationController","currentInstallationId","then","iid","_InstallationId","userController","getUserController","sessionToken","currentUserAsync","user","getSessionToken","token","_SessionToken","payloadString","_ref","returnStatus","_status","catch","errorJSON","INVALID_JSON","CONNECTION_FAILED","_setXHR","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,sDAAD,CAApC;;AAEA,IAAIC,gBAAgB,GAAGF,sBAAsB,CAACC,OAAO,CAAC,8DAAD,CAAR,CAA7C;;AAEA,IAAIE,iBAAiB,GAAGH,sBAAsB,CAACC,OAAO,CAAC,gEAAD,CAAR,CAA9C;;AAEA,IAAIG,0BAA0B,GAAGJ,sBAAsB,CAACC,OAAO,CAAC,2EAAD,CAAR,CAAvD;;AAEA,IAAII,QAAQ,GAAGL,sBAAsB,CAACC,OAAO,CAAC,yDAAD,CAAR,CAArC;;AAEA,IAAIK,yBAAyB,GAAGN,sBAAsB,CAACC,OAAO,CAAC,0EAAD,CAAR,CAAtD;;AAEA,IAAIM,OAAO,GAAGP,sBAAsB,CAACC,OAAO,CAAC,uDAAD,CAAR,CAApC;;AAEA,IAAIO,sBAAsB,GAAGR,sBAAsB,CAACC,OAAO,CAAC,uEAAD,CAAR,CAAnD;;AAEA,IAAIQ,KAAK,GAAGT,sBAAsB,CAACC,OAAO,CAAC,mDAAD,CAAR,CAAlC;;AAEA,IAAIS,gBAAgB,GAAGV,sBAAsB,CAACC,OAAO,CAAC,+CAAD,CAAR,CAA7C;;AAEA,IAAIU,QAAQ,GAAGX,sBAAsB,CAACC,OAAO,CAAC,uCAAD,CAAR,CAArC;;AAEA,IAAIW,YAAY,GAAGZ,sBAAsB,CAACC,OAAO,CAAC,mDAAD,CAAR,CAAzC;;AAEA,IAAIY,SAAS,GAAGb,sBAAsB,CAACC,OAAO,CAAC,yDAAD,CAAR,CAAtC;;AAEA,IAAIa,UAAU,GAAGd,sBAAsB,CAACC,OAAO,CAAC,sDAAD,CAAR,CAAvC;;AAEA,IAAIc,QAAQ,GAAGf,sBAAsB,CAACC,OAAO,CAAC,+CAAD,CAAR,CAArC;;AAEA,IAAIe,YAAY,GAAGhB,sBAAsB,CAACC,OAAO,CAAC,eAAD,CAAR,CAAzC;;AAEA,IAAIgB,WAAW,GAAGjB,sBAAsB,CAACC,OAAO,CAAC,cAAD,CAAR,CAAxC;;AAEA,SAASiB,OAAT,CAAiBC,MAAjB,EAAyBC,cAAzB,EAAyC;AACvC,MAAIC,IAAI,GAAG,CAAC,GAAGZ,KAAK,CAACa,OAAV,EAAmBH,MAAnB,CAAX;;AAEA,MAAIX,sBAAsB,CAACc,OAA3B,EAAoC;AAClC,QAAIC,OAAO,GAAG,CAAC,GAAGf,sBAAsB,CAACc,OAA3B,EAAoCH,MAApC,CAAd;AACA,QAAIC,cAAJ,EAAoBG,OAAO,GAAG,CAAC,GAAGhB,OAAO,CAACe,OAAZ,EAAqBC,OAArB,EAA8BC,IAA9B,CAAmCD,OAAnC,EAA4C,UAAUE,GAAV,EAAe;AACvF,aAAO,CAAC,GAAGnB,yBAAyB,CAACgB,OAA9B,EAAuCH,MAAvC,EAA+CM,GAA/C,EAAoDC,UAA3D;AACD,KAF6B,CAAV;AAGpBL,IAAAA,IAAI,CAACM,IAAL,CAAUC,KAAV,CAAgBP,IAAhB,EAAsBE,OAAtB;AACD;;AAED,SAAOF,IAAP;AACD;;AAED,SAASQ,aAAT,CAAuBC,MAAvB,EAA+B;AAC7B,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AACzC,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAT,IAAgB,IAAhB,GAAuBC,SAAS,CAACD,CAAD,CAAhC,GAAsC,EAAnD;;AAEA,QAAIA,CAAC,GAAG,CAAR,EAAW;AACT,UAAII,SAAJ;;AAEA,OAAC,GAAG9B,QAAQ,CAACiB,OAAb,EAAsBa,SAAS,GAAGjB,OAAO,CAACkB,MAAM,CAACF,MAAD,CAAP,EAAiB,IAAjB,CAAzC,EAAiEV,IAAjE,CAAsEW,SAAtE,EAAiF,UAAUE,GAAV,EAAe;AAC9F,SAAC,GAAG3B,gBAAgB,CAACY,OAArB,EAA8BQ,MAA9B,EAAsCO,GAAtC,EAA2CH,MAAM,CAACG,GAAD,CAAjD;AACD,OAFD;AAGD,KAND,MAMO,IAAIjC,0BAA0B,CAACkB,OAA/B,EAAwC;AAC7C,OAAC,GAAGnB,iBAAiB,CAACmB,OAAtB,EAA+BQ,MAA/B,EAAuC,CAAC,GAAG1B,0BAA0B,CAACkB,OAA/B,EAAwCY,MAAxC,CAAvC;AACD,KAFM,MAEA;AACL,UAAII,SAAJ;;AAEA,OAAC,GAAGjC,QAAQ,CAACiB,OAAb,EAAsBgB,SAAS,GAAGpB,OAAO,CAACkB,MAAM,CAACF,MAAD,CAAP,CAAzC,EAA2DV,IAA3D,CAAgEc,SAAhE,EAA2E,UAAUD,GAAV,EAAe;AACxF,SAAC,GAAGnC,gBAAgB,CAACoB,OAArB,EAA8BQ,MAA9B,EAAsCO,GAAtC,EAA2C,CAAC,GAAG/B,yBAAyB,CAACgB,OAA9B,EAAuCY,MAAvC,EAA+CG,GAA/C,CAA3C;AACD,OAFD;AAGD;AACF;;AAED,SAAOP,MAAP;AACD;;AAED,IAAIS,GAAG,GAAG,IAAV;;AAEA,IAAI,OAAOC,cAAP,KAA0B,WAA9B,EAA2C;AACzCD,EAAAA,GAAG,GAAGC,cAAN;AACD;;AAED,IAAIC,iBAAiB,GAAG,KAAxB;;AAEA,IAAI,OAAOC,cAAP,KAA0B,WAA1B,IAAyC,EAAE,qBAAqB,IAAIF,cAAJ,EAAvB,CAA7C,EAA2F;AACzFC,EAAAA,iBAAiB,GAAG,IAApB;AACD;;AAED,SAASE,OAAT,CAAiBC;AACjB;AADA,EAEEC;AACF;AAHA,EAIEC;AACF;AALA,EAMEC;AACF;AAPA,EAQEC;AACF;AATA,EAUE;AACA,SAAO,IAAIjC,QAAQ,CAACO,OAAb,CAAqB,UAAU2B,OAAV,EAAmBC,MAAnB,EAA2B;AACrD,QAAIC,GAAG,GAAG,IAAIT,cAAJ,EAAV;;AAEAS,IAAAA,GAAG,CAACC,MAAJ,GAAa,YAAY;AACvB,UAAIC,QAAJ;;AAEA,UAAI;AACFA,QAAAA,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWJ,GAAG,CAACK,YAAf,CAAX;AACD,OAFD,CAEE,OAAOC,CAAP,EAAU;AACVP,QAAAA,MAAM,CAACO,CAAD,CAAN;AACD;;AAED,UAAIJ,QAAJ,EAAc;AACZJ,QAAAA,OAAO,CAAC;AACNI,UAAAA,QAAQ,EAAEA;AADJ,SAAD,CAAP;AAGD;AACF,KAdD;;AAgBAF,IAAAA,GAAG,CAACO,OAAJ,GAAcP,GAAG,CAACQ,SAAJ,GAAgB,YAAY;AACxC;AACA,UAAIC,YAAY,GAAG;AACjBJ,QAAAA,YAAY,EAAE,CAAC,GAAG1C,UAAU,CAACQ,OAAf,EAAwB;AACpCuC,UAAAA,IAAI,EAAE5C,WAAW,CAACK,OAAZ,CAAoBwC,gBADU;AAEpCC,UAAAA,KAAK,EAAE;AAF6B,SAAxB;AADG,OAAnB;AAMAb,MAAAA,MAAM,CAACU,YAAD,CAAN;AACD,KATD;;AAWAT,IAAAA,GAAG,CAACa,UAAJ,GAAiB,YAAY;AAC3B,UAAIhB,OAAO,IAAI,OAAOA,OAAO,CAACiB,QAAf,KAA4B,UAA3C,EAAuD;AACrDjB,QAAAA,OAAO,CAACiB,QAAR,CAAiBd,GAAG,CAACK,YAArB;AACD;AACF,KAJD;;AAMAL,IAAAA,GAAG,CAACe,IAAJ,CAAStB,MAAT,EAAiBC,GAAjB;AACAM,IAAAA,GAAG,CAACgB,IAAJ,CAASrB,IAAT;;AAEA,QAAIE,OAAO,IAAI,OAAOA,OAAO,CAACoB,WAAf,KAA+B,UAA9C,EAA0D;AACxDpB,MAAAA,OAAO,CAACoB,WAAR,CAAoBjB,GAApB;AACD;AACF,GA1CM,CAAP;AA2CD;;AAED,IAAIkB,cAAc,GAAG;AACnBC,EAAAA,IAAI,EAAE,UAAU1B;AAChB;AADM,IAEJC;AACF;AAHM,IAIJC;AACF;AALM,IAMJC;AACF;AAPM,IAQJC;AACF;AATM,IAUJ;AACA,QAAIP,iBAAJ,EAAuB;AACrB,aAAOE,OAAO,CAACC,MAAD,EAASC,GAAT,EAAcC,IAAd,EAAoBC,OAApB,EAA6BC,OAA7B,CAAd;AACD;;AAED,QAAIuB,GAAJ,EAASC,GAAT;AACA,QAAIC,OAAO,GAAG,IAAI1D,QAAQ,CAACO,OAAb,CAAqB,UAAU2B,OAAV,EAAmBC,MAAnB,EAA2B;AAC5DqB,MAAAA,GAAG,GAAGtB,OAAN;AACAuB,MAAAA,GAAG,GAAGtB,MAAN;AACD,KAHa,CAAd;AAIAuB,IAAAA,OAAO,CAACxB,OAAR,GAAkBsB,GAAlB;AACAE,IAAAA,OAAO,CAACvB,MAAR,GAAiBsB,GAAjB;AACA,QAAIE,QAAQ,GAAG,CAAf;;AAEA,QAAIC,QAAQ,GAAG,SAASA,QAAT,GAAoB;AACjC,UAAIpC,GAAG,IAAI,IAAX,EAAiB;AACf,cAAM,IAAIqC,KAAJ,CAAU,mEAAV,CAAN;AACD;;AAED,UAAIC,OAAO,GAAG,KAAd;AACA,UAAIC,GAAG,GAAG,IAAIvC,GAAJ,EAAV;;AAEAuC,MAAAA,GAAG,CAACC,kBAAJ,GAAyB,YAAY;AACnC,YAAID,GAAG,CAACE,UAAJ,KAAmB,CAAnB,IAAwBH,OAAxB,IAAmCC,GAAG,CAACG,QAA3C,EAAqD;AACnD;AACD;;AAEDJ,QAAAA,OAAO,GAAG,IAAV;;AAEA,YAAIC,GAAG,CAACI,MAAJ,IAAc,GAAd,IAAqBJ,GAAG,CAACI,MAAJ,GAAa,GAAtC,EAA2C;AACzC,cAAI7B,QAAJ;;AAEA,cAAI;AACFA,YAAAA,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWuB,GAAG,CAACtB,YAAf,CAAX;;AAEA,gBAAI,OAAOsB,GAAG,CAACK,iBAAX,KAAiC,UAArC,EAAiD;AAC/C,kBAAIC,QAAJ;;AAEA,kBAAI,CAAC,GAAGvE,SAAS,CAACS,OAAd,EAAuB8D,QAAQ,GAAGN,GAAG,CAACO,qBAAJ,MAA+B,EAAjE,EAAqE7D,IAArE,CAA0E4D,QAA1E,EAAoF,yBAApF,CAAJ,EAAoH;AAClH/B,gBAAAA,QAAQ,GAAGyB,GAAG,CAACK,iBAAJ,CAAsB,uBAAtB,CAAX;AACD;AACF;AACF,WAVD,CAUE,OAAO1B,CAAP,EAAU;AACVgB,YAAAA,OAAO,CAACvB,MAAR,CAAeO,CAAC,CAAC6B,QAAF,EAAf;AACD;;AAED,cAAIjC,QAAJ,EAAc;AACZoB,YAAAA,OAAO,CAACxB,OAAR,CAAgB;AACdI,cAAAA,QAAQ,EAAEA,QADI;AAEd6B,cAAAA,MAAM,EAAEJ,GAAG,CAACI,MAFE;AAGdJ,cAAAA,GAAG,EAAEA;AAHS,aAAhB;AAKD;AACF,SAxBD,MAwBO,IAAIA,GAAG,CAACI,MAAJ,IAAc,GAAd,IAAqBJ,GAAG,CAACI,MAAJ,KAAe,CAAxC,EAA2C;AAChD;AACA,cAAI,EAAER,QAAF,GAAa1D,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,uBAAzB,CAAjB,EAAoE;AAClE;AACA,gBAAIC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,GAAhB,GAAsBF,IAAI,CAACG,GAAL,CAAS,CAAT,EAAYlB,QAAZ,CAAjC,CAAZ;AACA,aAAC,GAAG9D,YAAY,CAACU,OAAjB,EAA0BqD,QAA1B,EAAoCa,KAApC;AACD,WAJD,MAIO,IAAIV,GAAG,CAACI,MAAJ,KAAe,CAAnB,EAAsB;AAC3BT,YAAAA,OAAO,CAACvB,MAAR,CAAe,oCAAf;AACD,WAFM,MAEA;AACL;AACAuB,YAAAA,OAAO,CAACvB,MAAR,CAAe4B,GAAf;AACD;AACF,SAZM,MAYA;AACLL,UAAAA,OAAO,CAACvB,MAAR,CAAe4B,GAAf;AACD;AACF,OA9CD;;AAgDA/B,MAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AAEA,UAAI,OAAOA,OAAO,CAAC,cAAD,CAAd,KAAmC,QAAvC,EAAiD;AAC/CA,QAAAA,OAAO,CAAC,cAAD,CAAP,GAA0B,YAA1B,CAD+C,CACP;AACzC;;AAED,UAAI/B,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,SAAzB,CAAJ,EAAyC;AACvCxC,QAAAA,OAAO,CAAC,YAAD,CAAP,GAAwB,WAAW/B,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,SAAzB,CAAX,GAAiD,WAAjD,GAA+DM,OAAO,CAACC,QAAR,CAAiBC,IAAhF,GAAuF,GAA/G;AACD;;AAED,UAAI/E,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,kBAAzB,KAAgDvE,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,mBAAzB,CAApD,EAAmG;AACjGxC,QAAAA,OAAO,CAAC,eAAD,CAAP,GAA2B/B,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,kBAAzB,IAA+C,GAA/C,GAAqDvE,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,mBAAzB,CAAhF;AACD;;AAED,UAAIS,aAAa,GAAGhF,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,iBAAzB,CAApB;;AAEA,WAAK,IAAIlD,GAAT,IAAgB2D,aAAhB,EAA+B;AAC7BjD,QAAAA,OAAO,CAACV,GAAD,CAAP,GAAe2D,aAAa,CAAC3D,GAAD,CAA5B;AACD;;AAEDyC,MAAAA,GAAG,CAACd,UAAJ,GAAiB,UAAUiC,KAAV,EAAiB;AAChC,YAAIjD,OAAO,IAAI,OAAOA,OAAO,CAACiB,QAAf,KAA4B,UAA3C,EAAuD;AACrD,cAAIgC,KAAK,CAACC,gBAAV,EAA4B;AAC1BlD,YAAAA,OAAO,CAACiB,QAAR,CAAiBgC,KAAK,CAACE,MAAN,GAAeF,KAAK,CAACG,KAAtC,EAA6CH,KAAK,CAACE,MAAnD,EAA2DF,KAAK,CAACG,KAAjE;AACD,WAFD,MAEO;AACLpD,YAAAA,OAAO,CAACiB,QAAR,CAAiB,IAAjB;AACD;AACF;AACF,OARD;;AAUAa,MAAAA,GAAG,CAACZ,IAAJ,CAAStB,MAAT,EAAiBC,GAAjB,EAAsB,IAAtB;;AAEA,WAAK,IAAIwD,CAAT,IAActD,OAAd,EAAuB;AACrB+B,QAAAA,GAAG,CAACwB,gBAAJ,CAAqBD,CAArB,EAAwBtD,OAAO,CAACsD,CAAD,CAA/B;AACD;;AAEDvB,MAAAA,GAAG,CAACyB,OAAJ,GAAc,YAAY;AACxB9B,QAAAA,OAAO,CAACxB,OAAR,CAAgB;AACdI,UAAAA,QAAQ,EAAE;AACRmD,YAAAA,OAAO,EAAE;AADD,WADI;AAIdtB,UAAAA,MAAM,EAAE,CAJM;AAKdJ,UAAAA,GAAG,EAAEA;AALS,SAAhB;AAOD,OARD;;AAUAA,MAAAA,GAAG,CAACX,IAAJ,CAASrB,IAAT;;AAEA,UAAIE,OAAO,IAAI,OAAOA,OAAO,CAACoB,WAAf,KAA+B,UAA9C,EAA0D;AACxDpB,QAAAA,OAAO,CAACoB,WAAR,CAAoBU,GAApB;AACD;AACF,KA3GD;;AA6GAH,IAAAA,QAAQ;AACR,WAAOF,OAAP;AACD,GAxIkB;AAyInBgC,EAAAA,OAAO,EAAE,UAAU7D;AACnB;AADS,IAEP8D;AACF;AAHS,IAIP5D;AACF;AALS,IAMPE;AACF;AAPS,IAQP;AACAA,IAAAA,OAAO,GAAGA,OAAO,IAAI,EAArB;;AAEA,QAAIH,GAAG,GAAG7B,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,YAAzB,CAAV;;AAEA,QAAI1C,GAAG,CAACA,GAAG,CAACZ,MAAJ,GAAa,CAAd,CAAH,KAAwB,GAA5B,EAAiC;AAC/BY,MAAAA,GAAG,IAAI,GAAP;AACD;;AAEDA,IAAAA,GAAG,IAAI6D,IAAP;AACA,QAAIC,OAAO,GAAG,EAAd;;AAEA,QAAI7D,IAAI,IAAI,CAAC,GAAGnC,QAAQ,CAACW,OAAb,EAAsBwB,IAAtB,MAAgC,QAA5C,EAAsD;AACpD,WAAK,IAAI8D,CAAT,IAAc9D,IAAd,EAAoB;AAClB6D,QAAAA,OAAO,CAACC,CAAD,CAAP,GAAa9D,IAAI,CAAC8D,CAAD,CAAjB;AACD;AACF;;AAED,QAAIhE,MAAM,KAAK,MAAf,EAAuB;AACrB+D,MAAAA,OAAO,CAACE,OAAR,GAAkBjE,MAAlB;AACAA,MAAAA,MAAM,GAAG,MAAT;AACD;;AAED+D,IAAAA,OAAO,CAACG,cAAR,GAAyB9F,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,gBAAzB,CAAzB;;AAEA,QAAIwB,KAAK,GAAG/F,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,gBAAzB,CAAZ;;AAEA,QAAIwB,KAAJ,EAAW;AACTJ,MAAAA,OAAO,CAACK,cAAR,GAAyBD,KAAzB;AACD;;AAEDJ,IAAAA,OAAO,CAACM,cAAR,GAAyBjG,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,SAAzB,CAAzB;AACA,QAAI2B,YAAY,GAAGlE,OAAO,CAACkE,YAA3B;;AAEA,QAAI,OAAOA,YAAP,KAAwB,WAA5B,EAAyC;AACvCA,MAAAA,YAAY,GAAGlG,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,gBAAzB,CAAf;AACD;;AAED,QAAI2B,YAAJ,EAAkB;AAChB,UAAIlG,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,YAAzB,CAAJ,EAA4C;AAC1C,eAAOoB,OAAO,CAACK,cAAf;AACAL,QAAAA,OAAO,CAACQ,UAAR,GAAqBnG,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,YAAzB,CAArB;AACD,OAHD,MAGO;AACL,cAAM,IAAIX,KAAJ,CAAU,sDAAV,CAAN;AACD;AACF;;AAED,QAAI5D,YAAY,CAACM,OAAb,CAAqBiE,GAArB,CAAyB,yBAAzB,CAAJ,EAAyD;AACvDoB,MAAAA,OAAO,CAACS,iBAAR,GAA4B,GAA5B;AACD;;AAED,QAAIC,cAAc,GAAGrE,OAAO,CAACqE,cAA7B;AACA,QAAIC,qBAAJ;;AAEA,QAAID,cAAc,IAAI,OAAOA,cAAP,KAA0B,QAAhD,EAA0D;AACxDC,MAAAA,qBAAqB,GAAGvG,QAAQ,CAACO,OAAT,CAAiB2B,OAAjB,CAAyBoE,cAAzB,CAAxB;AACD,KAFD,MAEO;AACL,UAAIE,sBAAsB,GAAGvG,YAAY,CAACM,OAAb,CAAqBkG,yBAArB,EAA7B;;AAEAF,MAAAA,qBAAqB,GAAGC,sBAAsB,CAACE,qBAAvB,EAAxB;AACD;;AAED,WAAOH,qBAAqB,CAACI,IAAtB,CAA2B,UAAUC,GAAV,EAAe;AAC/ChB,MAAAA,OAAO,CAACiB,eAAR,GAA0BD,GAA1B;;AAEA,UAAIE,cAAc,GAAG7G,YAAY,CAACM,OAAb,CAAqBwG,iBAArB,EAArB;;AAEA,UAAI9E,OAAO,IAAI,OAAOA,OAAO,CAAC+E,YAAf,KAAgC,QAA/C,EAAyD;AACvD,eAAOhH,QAAQ,CAACO,OAAT,CAAiB2B,OAAjB,CAAyBD,OAAO,CAAC+E,YAAjC,CAAP;AACD,OAFD,MAEO,IAAIF,cAAJ,EAAoB;AACzB,eAAOA,cAAc,CAACG,gBAAf,GAAkCN,IAAlC,CAAuC,UAAUO,IAAV,EAAgB;AAC5D,cAAIA,IAAJ,EAAU;AACR,mBAAOlH,QAAQ,CAACO,OAAT,CAAiB2B,OAAjB,CAAyBgF,IAAI,CAACC,eAAL,EAAzB,CAAP;AACD;;AAED,iBAAOnH,QAAQ,CAACO,OAAT,CAAiB2B,OAAjB,CAAyB,IAAzB,CAAP;AACD,SANM,CAAP;AAOD;;AAED,aAAOlC,QAAQ,CAACO,OAAT,CAAiB2B,OAAjB,CAAyB,IAAzB,CAAP;AACD,KAlBM,EAkBJyE,IAlBI,CAkBC,UAAUS,KAAV,EAAiB;AACvB,UAAIA,KAAJ,EAAW;AACTxB,QAAAA,OAAO,CAACyB,aAAR,GAAwBD,KAAxB;AACD;;AAED,UAAIE,aAAa,GAAG,CAAC,GAAGvH,UAAU,CAACQ,OAAf,EAAwBqF,OAAxB,CAApB;AACA,aAAOtC,cAAc,CAACC,IAAf,CAAoB1B,MAApB,EAA4BC,GAA5B,EAAiCwF,aAAjC,EAAgD,EAAhD,EAAoDrF,OAApD,EAA6D0E,IAA7D,CAAkE,UAAUY,IAAV,EAAgB;AACvF,YAAIjF,QAAQ,GAAGiF,IAAI,CAACjF,QAApB;AAAA,YACI6B,MAAM,GAAGoD,IAAI,CAACpD,MADlB;;AAGA,YAAIlC,OAAO,CAACuF,YAAZ,EAA0B;AACxB,iBAAO1G,aAAa,CAAC,EAAD,EAAKwB,QAAL,EAAe;AACjCmF,YAAAA,OAAO,EAAEtD;AADwB,WAAf,CAApB;AAGD,SAJD,MAIO;AACL,iBAAO7B,QAAP;AACD;AACF,OAXM,CAAP;AAYD,KApCM,EAoCJoF,KApCI,CAoCE,UAAUpF;AACnB;AADS,MAEP;AACA;AACA;AACA,UAAIU,KAAJ;;AAEA,UAAIV,QAAQ,IAAIA,QAAQ,CAACG,YAAzB,EAAuC;AACrC,YAAI;AACF,cAAIkF,SAAS,GAAGpF,IAAI,CAACC,KAAL,CAAWF,QAAQ,CAACG,YAApB,CAAhB;AACAO,UAAAA,KAAK,GAAG,IAAI9C,WAAW,CAACK,OAAhB,CAAwBoH,SAAS,CAAC7E,IAAlC,EAAwC6E,SAAS,CAAC3E,KAAlD,CAAR;AACD,SAHD,CAGE,OAAON,CAAP,EAAU;AACV;AACAM,UAAAA,KAAK,GAAG,IAAI9C,WAAW,CAACK,OAAhB,CAAwBL,WAAW,CAACK,OAAZ,CAAoBqH,YAA5C,EAA0D,qDAAqDtF,QAAQ,CAACG,YAAxH,CAAR;AACD;AACF,OARD,MAQO;AACLO,QAAAA,KAAK,GAAG,IAAI9C,WAAW,CAACK,OAAhB,CAAwBL,WAAW,CAACK,OAAZ,CAAoBsH,iBAA5C,EAA+D,4BAA4B,CAAC,GAAG9H,UAAU,CAACQ,OAAf,EAAwB+B,QAAxB,CAA3F,CAAR;AACD;;AAED,aAAOtC,QAAQ,CAACO,OAAT,CAAiB4B,MAAjB,CAAwBa,KAAxB,CAAP;AACD,KAxDM,CAAP;AAyDD,GAxQkB;AAyQnB8E,EAAAA,OAAO,EAAE,UAAU/D;AACnB;AADS,IAEP;AACAvC,IAAAA,GAAG,GAAGuC,GAAN;AACD;AA7QkB,CAArB;AA+QAgE,MAAM,CAACC,OAAP,GAAiB1E,cAAjB","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\"));\n\nvar _defineProperties = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/define-properties\"));\n\nvar _getOwnPropertyDescriptors = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _getOwnPropertyDescriptor = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor\"));\n\nvar _filter = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/filter\"));\n\nvar _getOwnPropertySymbols = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/object/keys\"));\n\nvar _defineProperty3 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _typeof2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/typeof\"));\n\nvar _setTimeout2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/set-timeout\"));\n\nvar _includes = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/includes\"));\n\nvar _stringify = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/json/stringify\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/promise\"));\n\nvar _CoreManager = _interopRequireDefault(require(\"./CoreManager\"));\n\nvar _ParseError = _interopRequireDefault(require(\"./ParseError\"));\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = (0, _keys.default)(object);\n\n  if (_getOwnPropertySymbols.default) {\n    var symbols = (0, _getOwnPropertySymbols.default)(object);\n    if (enumerableOnly) symbols = (0, _filter.default)(symbols).call(symbols, function (sym) {\n      return (0, _getOwnPropertyDescriptor.default)(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      var _context2;\n\n      (0, _forEach.default)(_context2 = ownKeys(Object(source), true)).call(_context2, function (key) {\n        (0, _defineProperty3.default)(target, key, source[key]);\n      });\n    } else if (_getOwnPropertyDescriptors.default) {\n      (0, _defineProperties.default)(target, (0, _getOwnPropertyDescriptors.default)(source));\n    } else {\n      var _context3;\n\n      (0, _forEach.default)(_context3 = ownKeys(Object(source))).call(_context3, function (key) {\n        (0, _defineProperty2.default)(target, key, (0, _getOwnPropertyDescriptor.default)(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar XHR = null;\n\nif (typeof XMLHttpRequest !== 'undefined') {\n  XHR = XMLHttpRequest;\n}\n\nvar useXDomainRequest = false;\n\nif (typeof XDomainRequest !== 'undefined' && !('withCredentials' in new XMLHttpRequest())) {\n  useXDomainRequest = true;\n}\n\nfunction ajaxIE9(method\n/*: string*/\n, url\n/*: string*/\n, data\n/*: any*/\n, headers\n/*:: ?: any*/\n, options\n/*:: ?: FullOptions*/\n) {\n  return new _promise.default(function (resolve, reject) {\n    var xdr = new XDomainRequest();\n\n    xdr.onload = function () {\n      var response;\n\n      try {\n        response = JSON.parse(xdr.responseText);\n      } catch (e) {\n        reject(e);\n      }\n\n      if (response) {\n        resolve({\n          response: response\n        });\n      }\n    };\n\n    xdr.onerror = xdr.ontimeout = function () {\n      // Let's fake a real error message.\n      var fakeResponse = {\n        responseText: (0, _stringify.default)({\n          code: _ParseError.default.X_DOMAIN_REQUEST,\n          error: 'IE\\'s XDomainRequest does not supply error info.'\n        })\n      };\n      reject(fakeResponse);\n    };\n\n    xdr.onprogress = function () {\n      if (options && typeof options.progress === 'function') {\n        options.progress(xdr.responseText);\n      }\n    };\n\n    xdr.open(method, url);\n    xdr.send(data);\n\n    if (options && typeof options.requestTask === 'function') {\n      options.requestTask(xdr);\n    }\n  });\n}\n\nvar RESTController = {\n  ajax: function (method\n  /*: string*/\n  , url\n  /*: string*/\n  , data\n  /*: any*/\n  , headers\n  /*:: ?: any*/\n  , options\n  /*:: ?: FullOptions*/\n  ) {\n    if (useXDomainRequest) {\n      return ajaxIE9(method, url, data, headers, options);\n    }\n\n    var res, rej;\n    var promise = new _promise.default(function (resolve, reject) {\n      res = resolve;\n      rej = reject;\n    });\n    promise.resolve = res;\n    promise.reject = rej;\n    var attempts = 0;\n\n    var dispatch = function dispatch() {\n      if (XHR == null) {\n        throw new Error('Cannot make a request: No definition of XMLHttpRequest was found.');\n      }\n\n      var handled = false;\n      var xhr = new XHR();\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState !== 4 || handled || xhr._aborted) {\n          return;\n        }\n\n        handled = true;\n\n        if (xhr.status >= 200 && xhr.status < 300) {\n          var response;\n\n          try {\n            response = JSON.parse(xhr.responseText);\n\n            if (typeof xhr.getResponseHeader === 'function') {\n              var _context;\n\n              if ((0, _includes.default)(_context = xhr.getAllResponseHeaders() || '').call(_context, 'x-parse-job-status-id: ')) {\n                response = xhr.getResponseHeader('x-parse-job-status-id');\n              }\n            }\n          } catch (e) {\n            promise.reject(e.toString());\n          }\n\n          if (response) {\n            promise.resolve({\n              response: response,\n              status: xhr.status,\n              xhr: xhr\n            });\n          }\n        } else if (xhr.status >= 500 || xhr.status === 0) {\n          // retry on 5XX or node-xmlhttprequest error\n          if (++attempts < _CoreManager.default.get('REQUEST_ATTEMPT_LIMIT')) {\n            // Exponentially-growing random delay\n            var delay = Math.round(Math.random() * 125 * Math.pow(2, attempts));\n            (0, _setTimeout2.default)(dispatch, delay);\n          } else if (xhr.status === 0) {\n            promise.reject('Unable to connect to the Parse API');\n          } else {\n            // After the retry limit is reached, fail\n            promise.reject(xhr);\n          }\n        } else {\n          promise.reject(xhr);\n        }\n      };\n\n      headers = headers || {};\n\n      if (typeof headers['Content-Type'] !== 'string') {\n        headers['Content-Type'] = 'text/plain'; // Avoid pre-flight\n      }\n\n      if (_CoreManager.default.get('IS_NODE')) {\n        headers['User-Agent'] = 'Parse/' + _CoreManager.default.get('VERSION') + ' (NodeJS ' + process.versions.node + ')';\n      }\n\n      if (_CoreManager.default.get('SERVER_AUTH_TYPE') && _CoreManager.default.get('SERVER_AUTH_TOKEN')) {\n        headers['Authorization'] = _CoreManager.default.get('SERVER_AUTH_TYPE') + ' ' + _CoreManager.default.get('SERVER_AUTH_TOKEN');\n      }\n\n      var customHeaders = _CoreManager.default.get('REQUEST_HEADERS');\n\n      for (var key in customHeaders) {\n        headers[key] = customHeaders[key];\n      }\n\n      xhr.onprogress = function (event) {\n        if (options && typeof options.progress === 'function') {\n          if (event.lengthComputable) {\n            options.progress(event.loaded / event.total, event.loaded, event.total);\n          } else {\n            options.progress(null);\n          }\n        }\n      };\n\n      xhr.open(method, url, true);\n\n      for (var h in headers) {\n        xhr.setRequestHeader(h, headers[h]);\n      }\n\n      xhr.onabort = function () {\n        promise.resolve({\n          response: {\n            results: []\n          },\n          status: 0,\n          xhr: xhr\n        });\n      };\n\n      xhr.send(data);\n\n      if (options && typeof options.requestTask === 'function') {\n        options.requestTask(xhr);\n      }\n    };\n\n    dispatch();\n    return promise;\n  },\n  request: function (method\n  /*: string*/\n  , path\n  /*: string*/\n  , data\n  /*: mixed*/\n  , options\n  /*:: ?: RequestOptions*/\n  ) {\n    options = options || {};\n\n    var url = _CoreManager.default.get('SERVER_URL');\n\n    if (url[url.length - 1] !== '/') {\n      url += '/';\n    }\n\n    url += path;\n    var payload = {};\n\n    if (data && (0, _typeof2.default)(data) === 'object') {\n      for (var k in data) {\n        payload[k] = data[k];\n      }\n    }\n\n    if (method !== 'POST') {\n      payload._method = method;\n      method = 'POST';\n    }\n\n    payload._ApplicationId = _CoreManager.default.get('APPLICATION_ID');\n\n    var jsKey = _CoreManager.default.get('JAVASCRIPT_KEY');\n\n    if (jsKey) {\n      payload._JavaScriptKey = jsKey;\n    }\n\n    payload._ClientVersion = _CoreManager.default.get('VERSION');\n    var useMasterKey = options.useMasterKey;\n\n    if (typeof useMasterKey === 'undefined') {\n      useMasterKey = _CoreManager.default.get('USE_MASTER_KEY');\n    }\n\n    if (useMasterKey) {\n      if (_CoreManager.default.get('MASTER_KEY')) {\n        delete payload._JavaScriptKey;\n        payload._MasterKey = _CoreManager.default.get('MASTER_KEY');\n      } else {\n        throw new Error('Cannot use the Master Key, it has not been provided.');\n      }\n    }\n\n    if (_CoreManager.default.get('FORCE_REVOCABLE_SESSION')) {\n      payload._RevocableSession = '1';\n    }\n\n    var installationId = options.installationId;\n    var installationIdPromise;\n\n    if (installationId && typeof installationId === 'string') {\n      installationIdPromise = _promise.default.resolve(installationId);\n    } else {\n      var installationController = _CoreManager.default.getInstallationController();\n\n      installationIdPromise = installationController.currentInstallationId();\n    }\n\n    return installationIdPromise.then(function (iid) {\n      payload._InstallationId = iid;\n\n      var userController = _CoreManager.default.getUserController();\n\n      if (options && typeof options.sessionToken === 'string') {\n        return _promise.default.resolve(options.sessionToken);\n      } else if (userController) {\n        return userController.currentUserAsync().then(function (user) {\n          if (user) {\n            return _promise.default.resolve(user.getSessionToken());\n          }\n\n          return _promise.default.resolve(null);\n        });\n      }\n\n      return _promise.default.resolve(null);\n    }).then(function (token) {\n      if (token) {\n        payload._SessionToken = token;\n      }\n\n      var payloadString = (0, _stringify.default)(payload);\n      return RESTController.ajax(method, url, payloadString, {}, options).then(function (_ref) {\n        var response = _ref.response,\n            status = _ref.status;\n\n        if (options.returnStatus) {\n          return _objectSpread({}, response, {\n            _status: status\n          });\n        } else {\n          return response;\n        }\n      });\n    }).catch(function (response\n    /*: { responseText: string }*/\n    ) {\n      // Transform the error into an instance of ParseError by trying to parse\n      // the error string as JSON\n      var error;\n\n      if (response && response.responseText) {\n        try {\n          var errorJSON = JSON.parse(response.responseText);\n          error = new _ParseError.default(errorJSON.code, errorJSON.error);\n        } catch (e) {\n          // If we fail to parse the error text, that's okay.\n          error = new _ParseError.default(_ParseError.default.INVALID_JSON, 'Received an error with invalid JSON from Parse: ' + response.responseText);\n        }\n      } else {\n        error = new _ParseError.default(_ParseError.default.CONNECTION_FAILED, 'XMLHttpRequest failed: ' + (0, _stringify.default)(response));\n      }\n\n      return _promise.default.reject(error);\n    });\n  },\n  _setXHR: function (xhr\n  /*: any*/\n  ) {\n    XHR = xhr;\n  }\n};\nmodule.exports = RESTController;"]},"metadata":{},"sourceType":"script"}