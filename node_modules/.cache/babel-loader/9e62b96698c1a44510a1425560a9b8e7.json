{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.opFromJSON = opFromJSON;\nexports.RelationOp = exports.RemoveOp = exports.AddUniqueOp = exports.AddOp = exports.IncrementOp = exports.UnsetOp = exports.SetOp = exports.Op = void 0;\n\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\n\nvar _splice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/splice\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\n\nvar _arrayContainsObject = _interopRequireDefault(require(\"./arrayContainsObject\"));\n\nvar _decode = _interopRequireDefault(require(\"./decode\"));\n\nvar _encode = _interopRequireDefault(require(\"./encode\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseRelation = _interopRequireDefault(require(\"./ParseRelation\"));\n\nvar _unique = _interopRequireDefault(require(\"./unique\"));\n/**\n * Copyright (c) 2015-present, Parse, LLC.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @flow\n */\n\n\nfunction opFromJSON(json\n/*: { [key: string]: any }*/\n)\n/*: ?Op*/\n{\n  if (!json || !json.__op) {\n    return null;\n  }\n\n  switch (json.__op) {\n    case 'Delete':\n      return new UnsetOp();\n\n    case 'Increment':\n      return new IncrementOp(json.amount);\n\n    case 'Add':\n      return new AddOp((0, _decode.default)(json.objects));\n\n    case 'AddUnique':\n      return new AddUniqueOp((0, _decode.default)(json.objects));\n\n    case 'Remove':\n      return new RemoveOp((0, _decode.default)(json.objects));\n\n    case 'AddRelation':\n      {\n        var toAdd = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toAdd)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp(toAdd, []);\n      }\n\n    case 'RemoveRelation':\n      {\n        var toRemove = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toRemove)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp([], toRemove);\n      }\n\n    case 'Batch':\n      {\n        var _toAdd = [];\n        var _toRemove = [];\n\n        for (var i = 0; i < json.ops.length; i++) {\n          if (json.ops[i].__op === 'AddRelation') {\n            _toAdd = (0, _concat.default)(_toAdd).call(_toAdd, (0, _decode.default)(json.ops[i].objects));\n          } else if (json.ops[i].__op === 'RemoveRelation') {\n            _toRemove = (0, _concat.default)(_toRemove).call(_toRemove, (0, _decode.default)(json.ops[i].objects));\n          }\n        }\n\n        return new RelationOp(_toAdd, _toRemove);\n      }\n  }\n\n  return null;\n}\n\nvar Op =\n/*#__PURE__*/\nfunction () {\n  function Op() {\n    (0, _classCallCheck2.default)(this, Op);\n  }\n\n  (0, _createClass2.default)(Op, [{\n    key: \"applyTo\",\n    // Empty parent class\n    value: function ()\n    /*: mixed*/\n\n    /*: mixed*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: Op*/\n\n    /*: ?Op*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: mixed*/\n    {}\n  }]);\n  return Op;\n}();\n\nexports.Op = Op;\n\nvar SetOp =\n/*#__PURE__*/\nfunction (_Op) {\n  (0, _inherits2.default)(SetOp, _Op);\n\n  function SetOp(value\n  /*: mixed*/\n  ) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, SetOp);\n    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(SetOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"_value\", void 0);\n    _this._value = value;\n    return _this;\n  }\n\n  (0, _createClass2.default)(SetOp, [{\n    key: \"applyTo\",\n    value: function ()\n    /*: mixed*/\n    {\n      return this._value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: SetOp*/\n    {\n      return new SetOp(this._value);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function () {\n      return (0, _encode.default)(this._value, false, true);\n    }\n  }]);\n  return SetOp;\n}(Op);\n\nexports.SetOp = SetOp;\n\nvar UnsetOp =\n/*#__PURE__*/\nfunction (_Op2) {\n  (0, _inherits2.default)(UnsetOp, _Op2);\n\n  function UnsetOp() {\n    (0, _classCallCheck2.default)(this, UnsetOp);\n    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(UnsetOp).apply(this, arguments));\n  }\n\n  (0, _createClass2.default)(UnsetOp, [{\n    key: \"applyTo\",\n    value: function () {\n      return undefined;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: UnsetOp*/\n    {\n      return new UnsetOp();\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string }*/\n    {\n      return {\n        __op: 'Delete'\n      };\n    }\n  }]);\n  return UnsetOp;\n}(Op);\n\nexports.UnsetOp = UnsetOp;\n\nvar IncrementOp =\n/*#__PURE__*/\nfunction (_Op3) {\n  (0, _inherits2.default)(IncrementOp, _Op3);\n\n  function IncrementOp(amount\n  /*: number*/\n  ) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, IncrementOp);\n    _this2 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(IncrementOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this2), \"_amount\", void 0);\n\n    if (typeof amount !== 'number') {\n      throw new TypeError('Increment Op must be initialized with a numeric amount.');\n    }\n\n    _this2._amount = amount;\n    return _this2;\n  }\n\n  (0, _createClass2.default)(IncrementOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: ?mixed*/\n    )\n    /*: number*/\n    {\n      if (typeof value === 'undefined') {\n        return this._amount;\n      }\n\n      if (typeof value !== 'number') {\n        throw new TypeError('Cannot increment a non-numeric value.');\n      }\n\n      return this._amount + value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._amount);\n      }\n\n      if (previous instanceof IncrementOp) {\n        return new IncrementOp(this.applyTo(previous._amount));\n      }\n\n      throw new Error('Cannot merge Increment Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; amount: number }*/\n    {\n      return {\n        __op: 'Increment',\n        amount: this._amount\n      };\n    }\n  }]);\n  return IncrementOp;\n}(Op);\n\nexports.IncrementOp = IncrementOp;\n\nvar AddOp =\n/*#__PURE__*/\nfunction (_Op4) {\n  (0, _inherits2.default)(AddOp, _Op4);\n\n  function AddOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this3;\n\n    (0, _classCallCheck2.default)(this, AddOp);\n    _this3 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AddOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this3), \"_value\", void 0);\n    _this3._value = (0, _isArray.default)(value) ? value : [value];\n    return _this3;\n  }\n\n  (0, _createClass2.default)(AddOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value;\n      }\n\n      if ((0, _isArray.default)(value)) {\n        return (0, _concat.default)(value).call(value, this._value);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddOp) {\n        return new AddOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge Add Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'Add',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddOp;\n}(Op);\n\nexports.AddOp = AddOp;\n\nvar AddUniqueOp =\n/*#__PURE__*/\nfunction (_Op5) {\n  (0, _inherits2.default)(AddUniqueOp, _Op5);\n\n  function AddUniqueOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this4;\n\n    (0, _classCallCheck2.default)(this, AddUniqueOp);\n    _this4 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AddUniqueOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this4), \"_value\", void 0);\n    _this4._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this4;\n  }\n\n  (0, _createClass2.default)(AddUniqueOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value || [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        var _context; // copying value lets Flow guarantee the pointer isn't modified elsewhere\n\n\n        var valueCopy = value;\n        var toAdd = [];\n        (0, _forEach.default)(_context = this._value).call(_context, function (v) {\n          if (v instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(valueCopy, v)) {\n              toAdd.push(v);\n            }\n          } else {\n            if ((0, _indexOf.default)(valueCopy).call(valueCopy, v) < 0) {\n              toAdd.push(v);\n            }\n          }\n        });\n        return (0, _concat.default)(value).call(value, toAdd);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddUniqueOp) {\n        return new AddUniqueOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge AddUnique Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'AddUnique',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddUniqueOp;\n}(Op);\n\nexports.AddUniqueOp = AddUniqueOp;\n\nvar RemoveOp =\n/*#__PURE__*/\nfunction (_Op6) {\n  (0, _inherits2.default)(RemoveOp, _Op6);\n\n  function RemoveOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this5;\n\n    (0, _classCallCheck2.default)(this, RemoveOp);\n    _this5 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(RemoveOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this5), \"_value\", void 0);\n    _this5._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this5;\n  }\n\n  (0, _createClass2.default)(RemoveOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        // var i = value.indexOf(this._value);\n        var removed = (0, _concat.default)(value).call(value, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          var index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n\n          while (index > -1) {\n            (0, _splice.default)(removed).call(removed, index, 1);\n            index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n          }\n\n          if (this._value[i] instanceof _ParseObject.default && this._value[i].id) {\n            for (var j = 0; j < removed.length; j++) {\n              if (removed[j] instanceof _ParseObject.default && this._value[i].id === removed[j].id) {\n                (0, _splice.default)(removed).call(removed, j, 1);\n                j--;\n              }\n            }\n          }\n        }\n\n        return removed;\n      }\n\n      throw new Error('Cannot remove elements from a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new UnsetOp();\n      }\n\n      if (previous instanceof RemoveOp) {\n        var _context2;\n\n        var uniques = (0, _concat.default)(_context2 = previous._value).call(_context2, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          if (this._value[i] instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(uniques, this._value[i])) {\n              uniques.push(this._value[i]);\n            }\n          } else {\n            if ((0, _indexOf.default)(uniques).call(uniques, this._value[i]) < 0) {\n              uniques.push(this._value[i]);\n            }\n          }\n        }\n\n        return new RemoveOp(uniques);\n      }\n\n      throw new Error('Cannot merge Remove Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'Remove',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return RemoveOp;\n}(Op);\n\nexports.RemoveOp = RemoveOp;\n\nvar RelationOp =\n/*#__PURE__*/\nfunction (_Op7) {\n  (0, _inherits2.default)(RelationOp, _Op7);\n\n  function RelationOp(adds\n  /*: Array<ParseObject | string>*/\n  , removes\n  /*: Array<ParseObject | string>*/\n  ) {\n    var _this6;\n\n    (0, _classCallCheck2.default)(this, RelationOp);\n    _this6 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(RelationOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"_targetClassName\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToAdd\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToRemove\", void 0);\n    _this6._targetClassName = null;\n\n    if ((0, _isArray.default)(adds)) {\n      _this6.relationsToAdd = (0, _unique.default)((0, _map.default)(adds).call(adds, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    if ((0, _isArray.default)(removes)) {\n      _this6.relationsToRemove = (0, _unique.default)((0, _map.default)(removes).call(removes, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    return _this6;\n  }\n\n  (0, _createClass2.default)(RelationOp, [{\n    key: \"_extractId\",\n    value: function (obj\n    /*: string | ParseObject*/\n    )\n    /*: string*/\n    {\n      if (typeof obj === 'string') {\n        return obj;\n      }\n\n      if (!obj.id) {\n        throw new Error('You cannot add or remove an unsaved Parse Object from a relation');\n      }\n\n      if (!this._targetClassName) {\n        this._targetClassName = obj.className;\n      }\n\n      if (this._targetClassName !== obj.className) {\n        throw new Error('Tried to create a Relation with 2 different object types: ' + this._targetClassName + ' and ' + obj.className + '.');\n      }\n\n      return obj.id;\n    }\n  }, {\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    , object\n    /*:: ?: { className: string, id: ?string }*/\n    , key\n    /*:: ?: string*/\n    )\n    /*: ?ParseRelation*/\n    {\n      if (!value) {\n        var _context3;\n\n        if (!object || !key) {\n          throw new Error('Cannot apply a RelationOp without either a previous value, or an object and a key');\n        }\n\n        var parent = new _ParseObject.default(object.className);\n\n        if (object.id && (0, _indexOf.default)(_context3 = object.id).call(_context3, 'local') === 0) {\n          parent._localId = object.id;\n        } else if (object.id) {\n          parent.id = object.id;\n        }\n\n        var relation = new _ParseRelation.default(parent, key);\n        relation.targetClassName = this._targetClassName;\n        return relation;\n      }\n\n      if (value instanceof _ParseRelation.default) {\n        if (this._targetClassName) {\n          if (value.targetClassName) {\n            if (this._targetClassName !== value.targetClassName) {\n              throw new Error('Related object must be a ' + value.targetClassName + ', but a ' + this._targetClassName + ' was passed in.');\n            }\n          } else {\n            value.targetClassName = this._targetClassName;\n          }\n        }\n\n        return value;\n      } else {\n        throw new Error('Relation cannot be applied to a non-relation field');\n      }\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof UnsetOp) {\n        throw new Error('You cannot modify a relation after deleting it.');\n      } else if (previous instanceof SetOp && previous._value instanceof _ParseRelation.default) {\n        return this;\n      } else if (previous instanceof RelationOp) {\n        var _context4, _context5, _context6, _context7, _context8, _context9;\n\n        if (previous._targetClassName && previous._targetClassName !== this._targetClassName) {\n          throw new Error('Related object must be of class ' + previous._targetClassName + ', but ' + (this._targetClassName || 'null') + ' was passed in.');\n        }\n\n        var newAdd = (0, _concat.default)(_context4 = previous.relationsToAdd).call(_context4, []);\n        (0, _forEach.default)(_context5 = this.relationsToRemove).call(_context5, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newAdd).call(newAdd, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context6 = this.relationsToAdd).call(_context6, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index < 0) {\n            newAdd.push(r);\n          }\n        });\n        var newRemove = (0, _concat.default)(_context7 = previous.relationsToRemove).call(_context7, []);\n        (0, _forEach.default)(_context8 = this.relationsToAdd).call(_context8, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newRemove).call(newRemove, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context9 = this.relationsToRemove).call(_context9, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index < 0) {\n            newRemove.push(r);\n          }\n        });\n        var newRelation = new RelationOp(newAdd, newRemove);\n        newRelation._targetClassName = this._targetClassName;\n        return newRelation;\n      }\n\n      throw new Error('Cannot merge Relation Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op?: string; objects?: mixed; ops?: mixed }*/\n    {\n      var _this7 = this;\n\n      var idToPointer = function (id) {\n        return {\n          __type: 'Pointer',\n          className: _this7._targetClassName,\n          objectId: id\n        };\n      };\n\n      var adds = null;\n      var removes = null;\n      var pointers = null;\n\n      if (this.relationsToAdd.length > 0) {\n        var _context10;\n\n        pointers = (0, _map.default)(_context10 = this.relationsToAdd).call(_context10, idToPointer);\n        adds = {\n          __op: 'AddRelation',\n          objects: pointers\n        };\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        var _context11;\n\n        pointers = (0, _map.default)(_context11 = this.relationsToRemove).call(_context11, idToPointer);\n        removes = {\n          __op: 'RemoveRelation',\n          objects: pointers\n        };\n      }\n\n      if (adds && removes) {\n        return {\n          __op: 'Batch',\n          ops: [adds, removes]\n        };\n      }\n\n      return adds || removes || {};\n    }\n  }]);\n  return RelationOp;\n}(Op);\n\nexports.RelationOp = RelationOp;","map":{"version":3,"sources":["/home/roxana/React-Project/crud/node_modules/parse/lib/browser/ParseOp.js"],"names":["_interopRequireDefault","require","_Object$defineProperty","exports","value","opFromJSON","RelationOp","RemoveOp","AddUniqueOp","AddOp","IncrementOp","UnsetOp","SetOp","Op","_map","_splice","_indexOf","_forEach","_possibleConstructorReturn2","_getPrototypeOf2","_assertThisInitialized2","_inherits2","_defineProperty2","_classCallCheck2","_createClass2","_concat","_isArray","_arrayContainsObject","_decode","_encode","_ParseObject","_ParseRelation","_unique","json","__op","amount","default","objects","toAdd","toRemove","_toAdd","_toRemove","i","ops","length","call","key","_Op","_this","_value","_Op2","apply","arguments","undefined","_Op3","_this2","TypeError","_amount","previous","applyTo","Error","_Op4","_this3","_Op5","_this4","_context","valueCopy","v","push","_Op6","_this5","removed","index","id","j","_context2","uniques","_Op7","adds","removes","_this6","_targetClassName","relationsToAdd","_extractId","relationsToRemove","obj","className","object","_context3","parent","_localId","relation","targetClassName","_context4","_context5","_context6","_context7","_context8","_context9","newAdd","r","newRemove","newRelation","_this7","idToPointer","__type","objectId","pointers","_context10","_context11"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs3/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs3/core-js-stable/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.opFromJSON = opFromJSON;\nexports.RelationOp = exports.RemoveOp = exports.AddUniqueOp = exports.AddOp = exports.IncrementOp = exports.UnsetOp = exports.SetOp = exports.Op = void 0;\n\nvar _map = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/map\"));\n\nvar _splice = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/splice\"));\n\nvar _indexOf = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/index-of\"));\n\nvar _forEach = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/for-each\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/getPrototypeOf\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/defineProperty\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs3/helpers/createClass\"));\n\nvar _concat = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/instance/concat\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs3/core-js-stable/array/is-array\"));\n\nvar _arrayContainsObject = _interopRequireDefault(require(\"./arrayContainsObject\"));\n\nvar _decode = _interopRequireDefault(require(\"./decode\"));\n\nvar _encode = _interopRequireDefault(require(\"./encode\"));\n\nvar _ParseObject = _interopRequireDefault(require(\"./ParseObject\"));\n\nvar _ParseRelation = _interopRequireDefault(require(\"./ParseRelation\"));\n\nvar _unique = _interopRequireDefault(require(\"./unique\"));\n/**\n * Copyright (c) 2015-present, Parse, LLC.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n *\n * @flow\n */\n\n\nfunction opFromJSON(json\n/*: { [key: string]: any }*/\n)\n/*: ?Op*/\n{\n  if (!json || !json.__op) {\n    return null;\n  }\n\n  switch (json.__op) {\n    case 'Delete':\n      return new UnsetOp();\n\n    case 'Increment':\n      return new IncrementOp(json.amount);\n\n    case 'Add':\n      return new AddOp((0, _decode.default)(json.objects));\n\n    case 'AddUnique':\n      return new AddUniqueOp((0, _decode.default)(json.objects));\n\n    case 'Remove':\n      return new RemoveOp((0, _decode.default)(json.objects));\n\n    case 'AddRelation':\n      {\n        var toAdd = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toAdd)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp(toAdd, []);\n      }\n\n    case 'RemoveRelation':\n      {\n        var toRemove = (0, _decode.default)(json.objects);\n\n        if (!(0, _isArray.default)(toRemove)) {\n          return new RelationOp([], []);\n        }\n\n        return new RelationOp([], toRemove);\n      }\n\n    case 'Batch':\n      {\n        var _toAdd = [];\n        var _toRemove = [];\n\n        for (var i = 0; i < json.ops.length; i++) {\n          if (json.ops[i].__op === 'AddRelation') {\n            _toAdd = (0, _concat.default)(_toAdd).call(_toAdd, (0, _decode.default)(json.ops[i].objects));\n          } else if (json.ops[i].__op === 'RemoveRelation') {\n            _toRemove = (0, _concat.default)(_toRemove).call(_toRemove, (0, _decode.default)(json.ops[i].objects));\n          }\n        }\n\n        return new RelationOp(_toAdd, _toRemove);\n      }\n  }\n\n  return null;\n}\n\nvar Op =\n/*#__PURE__*/\nfunction () {\n  function Op() {\n    (0, _classCallCheck2.default)(this, Op);\n  }\n\n  (0, _createClass2.default)(Op, [{\n    key: \"applyTo\",\n    // Empty parent class\n    value: function ()\n    /*: mixed*/\n\n    /*: mixed*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: Op*/\n\n    /*: ?Op*/\n    {}\n    /* eslint-disable-line no-unused-vars */\n\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: mixed*/\n    {}\n  }]);\n  return Op;\n}();\n\nexports.Op = Op;\n\nvar SetOp =\n/*#__PURE__*/\nfunction (_Op) {\n  (0, _inherits2.default)(SetOp, _Op);\n\n  function SetOp(value\n  /*: mixed*/\n  ) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, SetOp);\n    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(SetOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this), \"_value\", void 0);\n    _this._value = value;\n    return _this;\n  }\n\n  (0, _createClass2.default)(SetOp, [{\n    key: \"applyTo\",\n    value: function ()\n    /*: mixed*/\n    {\n      return this._value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: SetOp*/\n    {\n      return new SetOp(this._value);\n    }\n  }, {\n    key: \"toJSON\",\n    value: function () {\n      return (0, _encode.default)(this._value, false, true);\n    }\n  }]);\n  return SetOp;\n}(Op);\n\nexports.SetOp = SetOp;\n\nvar UnsetOp =\n/*#__PURE__*/\nfunction (_Op2) {\n  (0, _inherits2.default)(UnsetOp, _Op2);\n\n  function UnsetOp() {\n    (0, _classCallCheck2.default)(this, UnsetOp);\n    return (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(UnsetOp).apply(this, arguments));\n  }\n\n  (0, _createClass2.default)(UnsetOp, [{\n    key: \"applyTo\",\n    value: function () {\n      return undefined;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function ()\n    /*: UnsetOp*/\n    {\n      return new UnsetOp();\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string }*/\n    {\n      return {\n        __op: 'Delete'\n      };\n    }\n  }]);\n  return UnsetOp;\n}(Op);\n\nexports.UnsetOp = UnsetOp;\n\nvar IncrementOp =\n/*#__PURE__*/\nfunction (_Op3) {\n  (0, _inherits2.default)(IncrementOp, _Op3);\n\n  function IncrementOp(amount\n  /*: number*/\n  ) {\n    var _this2;\n\n    (0, _classCallCheck2.default)(this, IncrementOp);\n    _this2 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(IncrementOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this2), \"_amount\", void 0);\n\n    if (typeof amount !== 'number') {\n      throw new TypeError('Increment Op must be initialized with a numeric amount.');\n    }\n\n    _this2._amount = amount;\n    return _this2;\n  }\n\n  (0, _createClass2.default)(IncrementOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: ?mixed*/\n    )\n    /*: number*/\n    {\n      if (typeof value === 'undefined') {\n        return this._amount;\n      }\n\n      if (typeof value !== 'number') {\n        throw new TypeError('Cannot increment a non-numeric value.');\n      }\n\n      return this._amount + value;\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._amount);\n      }\n\n      if (previous instanceof IncrementOp) {\n        return new IncrementOp(this.applyTo(previous._amount));\n      }\n\n      throw new Error('Cannot merge Increment Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; amount: number }*/\n    {\n      return {\n        __op: 'Increment',\n        amount: this._amount\n      };\n    }\n  }]);\n  return IncrementOp;\n}(Op);\n\nexports.IncrementOp = IncrementOp;\n\nvar AddOp =\n/*#__PURE__*/\nfunction (_Op4) {\n  (0, _inherits2.default)(AddOp, _Op4);\n\n  function AddOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this3;\n\n    (0, _classCallCheck2.default)(this, AddOp);\n    _this3 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AddOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this3), \"_value\", void 0);\n    _this3._value = (0, _isArray.default)(value) ? value : [value];\n    return _this3;\n  }\n\n  (0, _createClass2.default)(AddOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value;\n      }\n\n      if ((0, _isArray.default)(value)) {\n        return (0, _concat.default)(value).call(value, this._value);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddOp) {\n        return new AddOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge Add Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'Add',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddOp;\n}(Op);\n\nexports.AddOp = AddOp;\n\nvar AddUniqueOp =\n/*#__PURE__*/\nfunction (_Op5) {\n  (0, _inherits2.default)(AddUniqueOp, _Op5);\n\n  function AddUniqueOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this4;\n\n    (0, _classCallCheck2.default)(this, AddUniqueOp);\n    _this4 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(AddUniqueOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this4), \"_value\", void 0);\n    _this4._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this4;\n  }\n\n  (0, _createClass2.default)(AddUniqueOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return this._value || [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        var _context; // copying value lets Flow guarantee the pointer isn't modified elsewhere\n\n\n        var valueCopy = value;\n        var toAdd = [];\n        (0, _forEach.default)(_context = this._value).call(_context, function (v) {\n          if (v instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(valueCopy, v)) {\n              toAdd.push(v);\n            }\n          } else {\n            if ((0, _indexOf.default)(valueCopy).call(valueCopy, v) < 0) {\n              toAdd.push(v);\n            }\n          }\n        });\n        return (0, _concat.default)(value).call(value, toAdd);\n      }\n\n      throw new Error('Cannot add elements to a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new SetOp(this._value);\n      }\n\n      if (previous instanceof AddUniqueOp) {\n        return new AddUniqueOp(this.applyTo(previous._value));\n      }\n\n      throw new Error('Cannot merge AddUnique Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'AddUnique',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return AddUniqueOp;\n}(Op);\n\nexports.AddUniqueOp = AddUniqueOp;\n\nvar RemoveOp =\n/*#__PURE__*/\nfunction (_Op6) {\n  (0, _inherits2.default)(RemoveOp, _Op6);\n\n  function RemoveOp(value\n  /*: mixed | Array<mixed>*/\n  ) {\n    var _this5;\n\n    (0, _classCallCheck2.default)(this, RemoveOp);\n    _this5 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(RemoveOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this5), \"_value\", void 0);\n    _this5._value = (0, _unique.default)((0, _isArray.default)(value) ? value : [value]);\n    return _this5;\n  }\n\n  (0, _createClass2.default)(RemoveOp, [{\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed | Array<mixed>*/\n    )\n    /*: Array<mixed>*/\n    {\n      if (value == null) {\n        return [];\n      }\n\n      if ((0, _isArray.default)(value)) {\n        // var i = value.indexOf(this._value);\n        var removed = (0, _concat.default)(value).call(value, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          var index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n\n          while (index > -1) {\n            (0, _splice.default)(removed).call(removed, index, 1);\n            index = (0, _indexOf.default)(removed).call(removed, this._value[i]);\n          }\n\n          if (this._value[i] instanceof _ParseObject.default && this._value[i].id) {\n            for (var j = 0; j < removed.length; j++) {\n              if (removed[j] instanceof _ParseObject.default && this._value[i].id === removed[j].id) {\n                (0, _splice.default)(removed).call(removed, j, 1);\n                j--;\n              }\n            }\n          }\n        }\n\n        return removed;\n      }\n\n      throw new Error('Cannot remove elements from a non-array value');\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      }\n\n      if (previous instanceof SetOp) {\n        return new SetOp(this.applyTo(previous._value));\n      }\n\n      if (previous instanceof UnsetOp) {\n        return new UnsetOp();\n      }\n\n      if (previous instanceof RemoveOp) {\n        var _context2;\n\n        var uniques = (0, _concat.default)(_context2 = previous._value).call(_context2, []);\n\n        for (var i = 0; i < this._value.length; i++) {\n          if (this._value[i] instanceof _ParseObject.default) {\n            if (!(0, _arrayContainsObject.default)(uniques, this._value[i])) {\n              uniques.push(this._value[i]);\n            }\n          } else {\n            if ((0, _indexOf.default)(uniques).call(uniques, this._value[i]) < 0) {\n              uniques.push(this._value[i]);\n            }\n          }\n        }\n\n        return new RemoveOp(uniques);\n      }\n\n      throw new Error('Cannot merge Remove Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op: string; objects: mixed }*/\n    {\n      return {\n        __op: 'Remove',\n        objects: (0, _encode.default)(this._value, false, true)\n      };\n    }\n  }]);\n  return RemoveOp;\n}(Op);\n\nexports.RemoveOp = RemoveOp;\n\nvar RelationOp =\n/*#__PURE__*/\nfunction (_Op7) {\n  (0, _inherits2.default)(RelationOp, _Op7);\n\n  function RelationOp(adds\n  /*: Array<ParseObject | string>*/\n  , removes\n  /*: Array<ParseObject | string>*/\n  ) {\n    var _this6;\n\n    (0, _classCallCheck2.default)(this, RelationOp);\n    _this6 = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(RelationOp).call(this));\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"_targetClassName\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToAdd\", void 0);\n    (0, _defineProperty2.default)((0, _assertThisInitialized2.default)(_this6), \"relationsToRemove\", void 0);\n    _this6._targetClassName = null;\n\n    if ((0, _isArray.default)(adds)) {\n      _this6.relationsToAdd = (0, _unique.default)((0, _map.default)(adds).call(adds, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    if ((0, _isArray.default)(removes)) {\n      _this6.relationsToRemove = (0, _unique.default)((0, _map.default)(removes).call(removes, _this6._extractId, (0, _assertThisInitialized2.default)(_this6)));\n    }\n\n    return _this6;\n  }\n\n  (0, _createClass2.default)(RelationOp, [{\n    key: \"_extractId\",\n    value: function (obj\n    /*: string | ParseObject*/\n    )\n    /*: string*/\n    {\n      if (typeof obj === 'string') {\n        return obj;\n      }\n\n      if (!obj.id) {\n        throw new Error('You cannot add or remove an unsaved Parse Object from a relation');\n      }\n\n      if (!this._targetClassName) {\n        this._targetClassName = obj.className;\n      }\n\n      if (this._targetClassName !== obj.className) {\n        throw new Error('Tried to create a Relation with 2 different object types: ' + this._targetClassName + ' and ' + obj.className + '.');\n      }\n\n      return obj.id;\n    }\n  }, {\n    key: \"applyTo\",\n    value: function (value\n    /*: mixed*/\n    , object\n    /*:: ?: { className: string, id: ?string }*/\n    , key\n    /*:: ?: string*/\n    )\n    /*: ?ParseRelation*/\n    {\n      if (!value) {\n        var _context3;\n\n        if (!object || !key) {\n          throw new Error('Cannot apply a RelationOp without either a previous value, or an object and a key');\n        }\n\n        var parent = new _ParseObject.default(object.className);\n\n        if (object.id && (0, _indexOf.default)(_context3 = object.id).call(_context3, 'local') === 0) {\n          parent._localId = object.id;\n        } else if (object.id) {\n          parent.id = object.id;\n        }\n\n        var relation = new _ParseRelation.default(parent, key);\n        relation.targetClassName = this._targetClassName;\n        return relation;\n      }\n\n      if (value instanceof _ParseRelation.default) {\n        if (this._targetClassName) {\n          if (value.targetClassName) {\n            if (this._targetClassName !== value.targetClassName) {\n              throw new Error('Related object must be a ' + value.targetClassName + ', but a ' + this._targetClassName + ' was passed in.');\n            }\n          } else {\n            value.targetClassName = this._targetClassName;\n          }\n        }\n\n        return value;\n      } else {\n        throw new Error('Relation cannot be applied to a non-relation field');\n      }\n    }\n  }, {\n    key: \"mergeWith\",\n    value: function (previous\n    /*: Op*/\n    )\n    /*: Op*/\n    {\n      if (!previous) {\n        return this;\n      } else if (previous instanceof UnsetOp) {\n        throw new Error('You cannot modify a relation after deleting it.');\n      } else if (previous instanceof SetOp && previous._value instanceof _ParseRelation.default) {\n        return this;\n      } else if (previous instanceof RelationOp) {\n        var _context4, _context5, _context6, _context7, _context8, _context9;\n\n        if (previous._targetClassName && previous._targetClassName !== this._targetClassName) {\n          throw new Error('Related object must be of class ' + previous._targetClassName + ', but ' + (this._targetClassName || 'null') + ' was passed in.');\n        }\n\n        var newAdd = (0, _concat.default)(_context4 = previous.relationsToAdd).call(_context4, []);\n        (0, _forEach.default)(_context5 = this.relationsToRemove).call(_context5, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newAdd).call(newAdd, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context6 = this.relationsToAdd).call(_context6, function (r) {\n          var index = (0, _indexOf.default)(newAdd).call(newAdd, r);\n\n          if (index < 0) {\n            newAdd.push(r);\n          }\n        });\n        var newRemove = (0, _concat.default)(_context7 = previous.relationsToRemove).call(_context7, []);\n        (0, _forEach.default)(_context8 = this.relationsToAdd).call(_context8, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index > -1) {\n            (0, _splice.default)(newRemove).call(newRemove, index, 1);\n          }\n        });\n        (0, _forEach.default)(_context9 = this.relationsToRemove).call(_context9, function (r) {\n          var index = (0, _indexOf.default)(newRemove).call(newRemove, r);\n\n          if (index < 0) {\n            newRemove.push(r);\n          }\n        });\n        var newRelation = new RelationOp(newAdd, newRemove);\n        newRelation._targetClassName = this._targetClassName;\n        return newRelation;\n      }\n\n      throw new Error('Cannot merge Relation Op with the previous Op');\n    }\n  }, {\n    key: \"toJSON\",\n    value: function ()\n    /*: { __op?: string; objects?: mixed; ops?: mixed }*/\n    {\n      var _this7 = this;\n\n      var idToPointer = function (id) {\n        return {\n          __type: 'Pointer',\n          className: _this7._targetClassName,\n          objectId: id\n        };\n      };\n\n      var adds = null;\n      var removes = null;\n      var pointers = null;\n\n      if (this.relationsToAdd.length > 0) {\n        var _context10;\n\n        pointers = (0, _map.default)(_context10 = this.relationsToAdd).call(_context10, idToPointer);\n        adds = {\n          __op: 'AddRelation',\n          objects: pointers\n        };\n      }\n\n      if (this.relationsToRemove.length > 0) {\n        var _context11;\n\n        pointers = (0, _map.default)(_context11 = this.relationsToRemove).call(_context11, idToPointer);\n        removes = {\n          __op: 'RemoveRelation',\n          objects: pointers\n        };\n      }\n\n      if (adds && removes) {\n        return {\n          __op: 'Batch',\n          ops: [adds, removes]\n        };\n      }\n\n      return adds || removes || {};\n    }\n  }]);\n  return RelationOp;\n}(Op);\n\nexports.RelationOp = RelationOp;"]},"metadata":{},"sourceType":"script"}